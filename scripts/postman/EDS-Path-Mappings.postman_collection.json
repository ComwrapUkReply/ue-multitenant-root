{
  "info": {
    "name": "EDS Path Mappings - ue-multitenant-root",
    "_postman_id": "eds-path-mappings-ue-multitenant",
    "description": "Edge Delivery Services Admin API calls for configuring path mappings in RepoLess setup.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "auth_token",
      "value": "<YOUR_AUTH_TOKEN>",
      "type": "string",
      "description": "Your Edge Delivery Admin API auth token from https://admin.hlx.page/login"
    },
    {
      "key": "org",
      "value": "ComwrapUkReply",
      "type": "string"
    },
    {
      "key": "site",
      "value": "ue-multitenant-root",
      "type": "string"
    },
    {
      "key": "admin_api",
      "value": "https://admin.hlx.page/config",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Get Current Configuration",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "x-auth-token",
            "value": "{{auth_token}}",
            "type": "text"
          },
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{admin_api}}/{{org}}/sites/{{site}}.json",
          "host": [
            "{{admin_api}}"
          ],
          "path": [
            "{{org}}",
            "sites",
            "{{site}}.json"
          ]
        },
        "description": "Retrieves the current configuration for the site including code source, content source, and path mappings."
      },
      "response": []
    },
    {
      "name": "2. Update Path Mappings",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          },
          {
            "key": "x-auth-token",
            "value": "{{auth_token}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"paths\": {\n        \"mappings\": [\n            \"/content/ue-multitenant-root/:/\",\n            \"/content/ue-multitenant-root/configuration:/.helix/config.json\",\n            \"/content/ue-multitenant-root.resource/query-index.json:/query-index.json\",\n            \"/content/ue-multitenant-root.resource/blog-index.json:/blog-index.json\"\n        ],\n        \"includes\": [\n            \"/content/ue-multitenant-root/\",\n            \"/content/dam/ue-multitenant-root/\"\n        ]\n    }\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{admin_api}}/{{org}}/sites/{{site}}/public.json",
          "host": [
            "{{admin_api}}"
          ],
          "path": [
            "{{org}}",
            "sites",
            "{{site}}",
            "public.json"
          ]
        },
        "description": "Updates the path mappings for the site. This maps:\n- /content/ue-multitenant-root/ -> /\n- /content/ue-multitenant-root/configuration -> /.helix/config.json\n- /content/ue-multitenant-root.resource/query-index.json -> /query-index.json\n- /content/ue-multitenant-root.resource/blog-index.json -> /blog-index.json"
      },
      "response": []
    },
    {
      "name": "3. Verify Configuration",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "x-auth-token",
            "value": "{{auth_token}}",
            "type": "text"
          },
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{admin_api}}/{{org}}/sites/{{site}}.json",
          "host": [
            "{{admin_api}}"
          ],
          "path": [
            "{{org}}",
            "sites",
            "{{site}}.json"
          ]
        },
        "description": "Verifies the configuration was updated correctly by fetching the current site configuration."
      },
      "response": []
    },
    {
      "name": "4. Test Query Index (Page)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://main--{{site}}--comwrapukreply.aem.page/query-index.json",
          "protocol": "https",
          "host": [
            "main--{{site}}--comwrapukreply",
            "aem",
            "page"
          ],
          "path": [
            "query-index.json"
          ]
        },
        "description": "Tests that the query-index.json is accessible on the Edge Delivery page domain."
      },
      "response": []
    },
    {
      "name": "5. Test Query Index (Live)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://main--{{site}}--comwrapukreply.aem.live/query-index.json",
          "protocol": "https",
          "host": [
            "main--{{site}}--comwrapukreply",
            "aem",
            "live"
          ],
          "path": [
            "query-index.json"
          ]
        },
        "description": "Tests that the query-index.json is accessible on the Edge Delivery live domain."
      },
      "response": []
    },
    {
      "name": "6. Update Access Control",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          },
          {
            "key": "x-auth-token",
            "value": "{{auth_token}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"admin\": {\n        \"role\": {\n            \"admin\": [\n                \"s.sznajder@reply.com\"\n            ],\n            \"config_admin\": [\n                \"B0AC1E69623B0F1F0A495EC0@techacct.adobe.com\"\n            ]\n        },\n        \"requireAuth\": \"auto\"\n    }\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{admin_api}}/{{org}}/sites/{{site}}/access.json",
          "host": [
            "{{admin_api}}"
          ],
          "path": [
            "{{org}}",
            "sites",
            "{{site}}",
            "access.json"
          ]
        },
        "description": "Updates access control settings for the site (optional)."
      },
      "response": []
    }
  ]
}
